2024-11-01 00:19:36,413 INFO: 
  name: test_RealDAT_x4_exp1
  model_type: RealDATModel
  scale: 4
  num_gpu: 1
  manual_seed: 10
  datasets:[
    test_1:[
      task: SR
      name: DIV2K
      type: PairedImageDataset
      dataroot_gt: datasets/DIV2K/DIV2K_valid_HR
      dataroot_lq: datasets/DIV2K/DIV2K_valid_LR_real/X4
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      phase: test
      scale: 4
    ]
    test_2:[
      task: SR
      name: LSDIR
      type: PairedImageDataset
      dataroot_gt: datasets/LSDIR/data/HR/val
      dataroot_lq: datasets/LSDIR/data/RealLQx4/val
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      phase: test
      scale: 4
    ]
    test_3:[
      task: SR
      name: RealSR_Cannon
      type: PairedImageDataset
      dataroot_gt: datasets/RealSRv3/Canon/Test/HR/X4
      dataroot_lq: datasets/RealSRv3/Canon/Test/LR/X4
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      phase: test
      scale: 4
    ]
    test_4:[
      task: SR
      name: RealSR_Nikon
      type: PairedImageDataset
      dataroot_gt: datasets/RealSRv3/Nikon/Test/HR/X4
      dataroot_lq: datasets/RealSRv3/Nikon/Test/LR/X4
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      phase: test
      scale: 4
    ]
    test_5:[
      task: SR
      name: Set5
      type: PairedImageDataset
      dataroot_gt: datasets/Set5/GTmod12
      dataroot_lq: datasets/Set5/LRbicx4
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      phase: test
      scale: 4
    ]
    test_6:[
      task: SR
      name: Set14
      type: PairedImageDataset
      dataroot_gt: datasets/Set14/GTmod12
      dataroot_lq: datasets/Set14/LRbicx4
      filename_tmpl: {}
      io_backend:[
        type: disk
      ]
      phase: test
      scale: 4
    ]
  ]
  network_g:[
    type: RealDAT
    upscale: 4
    in_chans: 3
    img_size: 64
    img_range: 1.0
    split_size: [8, 32]
    depth: [6, 6, 6, 6, 6, 6]
    embed_dim: 180
    num_heads: [6, 6, 6, 6, 6, 6]
    expansion_factor: 4
    resi_connection: 1conv
    fusion_layers: all
  ]
  network_clip:[
    type: srclipv2_ViT-B-32
  ]
  path:[
    pretrain_network_g: experiments/train_RealDAT_x4_bs4_srclip/models/net_g_450000.pth
    srclip_pretrain_network: logs/srclipv2_ViT-B-32_siglip_b512x1_lr2e-5_e100_fix_exp1/checkpoints/epoch_30.pt
    strict_load_g: True
    results_root: /home/cxx5/cxx/codefield/SR/SrClip/results/test_RealDAT_x4_exp1
    log: /home/cxx5/cxx/codefield/SR/SrClip/results/test_RealDAT_x4_exp1
    visualization: /home/cxx5/cxx/codefield/SR/SrClip/results/test_RealDAT_x4_exp1/visualization
  ]
  val:[
    save_img: True
    suffix: None
    use_chop: True
    pbar: True
    metrics:[
      psnr:[
        type: calculate_psnr
        crop_border: 2
        test_y_channel: True
      ]
      ssim:[
        type: calculate_ssim
        crop_border: 2
        test_y_channel: True
      ]
    ]
  ]
  dist: False
  rank: 0
  world_size: 1
  auto_resume: False
  is_train: False

2024-11-01 00:19:36,417 INFO: Dataset [PairedImageDataset] - DIV2K is built.
2024-11-01 00:19:36,417 INFO: Number of test images in DIV2K: 100
2024-11-01 00:19:36,424 INFO: Dataset [PairedImageDataset] - LSDIR is built.
2024-11-01 00:19:36,424 INFO: Number of test images in LSDIR: 238
2024-11-01 00:19:36,426 INFO: Dataset [PairedImageDataset] - RealSR_Cannon is built.
2024-11-01 00:19:36,426 INFO: Number of test images in RealSR_Cannon: 50
2024-11-01 00:19:36,428 INFO: Dataset [PairedImageDataset] - RealSR_Nikon is built.
2024-11-01 00:19:36,428 INFO: Number of test images in RealSR_Nikon: 50
2024-11-01 00:19:36,428 INFO: Dataset [PairedImageDataset] - Set5 is built.
2024-11-01 00:19:36,428 INFO: Number of test images in Set5: 5
2024-11-01 00:19:36,429 INFO: Dataset [PairedImageDataset] - Set14 is built.
2024-11-01 00:19:36,429 INFO: Number of test images in Set14: 14
2024-11-01 00:19:37,095 INFO: Network [RealDAT] is created.
2024-11-01 00:19:37,333 INFO: Network: RealDAT, with parameters: 18,061,131
2024-11-01 00:19:37,333 INFO: RealDAT(
  (conv_first): Conv2d(3, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (before_RG): Sequential(
    (0): Rearrange('b c h w -> b (h w) c')
    (1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
  )
  (layers): ModuleList(
    (0): ResidualGroup(
      (blocks): ModuleList(
        (0): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): Identity()
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (1): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.003)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (2): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.006)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (3): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.009)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (4): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.011)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (5): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.014)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
      )
      (conv): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (1): ResidualGroup(
      (blocks): ModuleList(
        (0): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.017)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (1): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.020)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (2): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.023)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (3): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.026)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (4): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.029)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (5): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.031)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
      )
      (conv): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (2): ResidualGroup(
      (blocks): ModuleList(
        (0): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.034)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (1): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.037)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (2): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.040)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (3): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.043)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (4): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.046)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (5): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.049)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
      )
      (conv): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (3): ResidualGroup(
      (blocks): ModuleList(
        (0): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.051)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (1): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.054)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (2): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.057)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (3): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.060)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (4): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.063)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (5): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.066)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
      )
      (conv): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (4): ResidualGroup(
      (blocks): ModuleList(
        (0): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.069)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (1): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.071)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (2): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.074)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (3): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.077)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (4): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.080)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (5): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.083)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
      )
      (conv): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
    (5): ResidualGroup(
      (blocks): ModuleList(
        (0): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.086)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (1): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.089)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (2): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.091)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (3): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.094)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (4): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Spatial_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (attns): ModuleList(
              (0-1): 2 x Spatial_Attention(
                (pos): DynamicPosBias(
                  (pos_proj): Linear(in_features=2, out_features=5, bias=True)
                  (pos1): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos2): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=5, bias=True)
                  )
                  (pos3): Sequential(
                    (0): LayerNorm((5,), eps=1e-05, elementwise_affine=True)
                    (1): ReLU(inplace=True)
                    (2): Linear(in_features=5, out_features=3, bias=True)
                  )
                )
                (attn_drop): Dropout(p=0.0, inplace=False)
              )
            )
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.097)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
        (5): DATB(
          (norm1): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
          (attn): Adaptive_Channel_Attention(
            (qkv): Linear(in_features=180, out_features=540, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=180, out_features=180, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (dwconv): Sequential(
              (0): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=180)
              (1): BatchNorm2d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
            )
            (channel_interaction): Sequential(
              (0): AdaptiveAvgPool2d(output_size=1)
              (1): Conv2d(180, 22, kernel_size=(1, 1), stride=(1, 1))
              (2): BatchNorm2d(22, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (3): GELU(approximate='none')
              (4): Conv2d(22, 180, kernel_size=(1, 1), stride=(1, 1))
            )
            (spatial_interaction): Sequential(
              (0): Conv2d(180, 11, kernel_size=(1, 1), stride=(1, 1))
              (1): BatchNorm2d(11, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (2): GELU(approximate='none')
              (3): Conv2d(11, 1, kernel_size=(1, 1), stride=(1, 1))
            )
          )
          (drop_path): DropPath(drop_prob=0.100)
          (ffn): SGFN(
            (fc1): Linear(in_features=180, out_features=720, bias=True)
            (act): GELU(approximate='none')
            (sg): SpatialGate(
              (norm): LayerNorm((360,), eps=1e-05, elementwise_affine=True)
              (conv): Conv2d(360, 360, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=360)
            )
            (fc2): Linear(in_features=360, out_features=180, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
          (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
        )
      )
      (conv): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    )
  )
  (norm): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
  (conv_after_body): Conv2d(180, 180, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv_before_upsample): Sequential(
    (0): Conv2d(180, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): LeakyReLU(negative_slope=0.01, inplace=True)
  )
  (upsample): Upsample(
    (0): Conv2d(64, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): PixelShuffle(upscale_factor=2)
    (2): Conv2d(64, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (3): PixelShuffle(upscale_factor=2)
  )
  (conv_last): Conv2d(64, 3, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (fusion_blocks): ModuleList(
    (0-5): 6 x FusionBlock(
      (norm1_x): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
      (norm1_xd): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
      (norm1_xi): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
      (attn): CrossAttention_Fusion(
        (attn_i): CrossAttention(
          (q): Linear(in_features=180, out_features=180, bias=True)
          (kv): Linear(in_features=180, out_features=360, bias=True)
          (attn_drop): Dropout(p=0, inplace=False)
          (proj): Linear(in_features=180, out_features=180, bias=True)
          (proj_drop): Dropout(p=0, inplace=False)
        )
        (attn_d): CrossAttention(
          (q): Linear(in_features=180, out_features=180, bias=True)
          (kv): Linear(in_features=180, out_features=360, bias=True)
          (attn_drop): Dropout(p=0, inplace=False)
          (proj): Linear(in_features=180, out_features=180, bias=True)
          (proj_drop): Dropout(p=0, inplace=False)
        )
        (q): Linear(in_features=180, out_features=180, bias=True)
        (k): Linear(in_features=360, out_features=180, bias=True)
        (v): Linear(in_features=360, out_features=180, bias=True)
        (attn_drop): Dropout(p=0, inplace=False)
        (proj): Linear(in_features=180, out_features=180, bias=True)
        (proj_drop): Dropout(p=0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((180,), eps=1e-05, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=180, out_features=180, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=180, out_features=180, bias=True)
        (drop2): Dropout(p=0, inplace=False)
      )
    )
  )
  (adaptive_feat_channels): Sequential(
    (0): Linear(in_features=512, out_features=180, bias=True)
    (1): ReLU()
    (2): Linear(in_features=180, out_features=180, bias=True)
    (3): ReLU()
  )
)
2024-11-01 00:19:38,786 INFO: Loading RealDAT model from experiments/train_RealDAT_x4_bs4_srclip/models/net_g_450000.pth, with param key: [params].
2024-11-01 00:19:41,942 INFO: Model [RealDATModel] is created.
2024-11-01 00:19:41,942 INFO: Testing DIV2K...
2024-11-01 00:28:03,597 INFO: Validation DIV2K
	 # psnr: 25.2728	Best: 25.2728 @ test_RealDAT_x4_exp1 iter
	 # ssim: 0.6873	Best: 0.6873 @ test_RealDAT_x4_exp1 iter

2024-11-01 00:28:03,604 INFO: Testing LSDIR...
2024-11-01 00:37:08,780 INFO: Validation LSDIR
	 # psnr: 22.5314	Best: 22.5314 @ test_RealDAT_x4_exp1 iter
	 # ssim: 0.5869	Best: 0.5869 @ test_RealDAT_x4_exp1 iter

2024-11-01 00:37:08,780 INFO: Testing RealSR_Cannon...
2024-11-01 00:39:33,460 INFO: Validation RealSR_Cannon
	 # psnr: 28.5840	Best: 28.5840 @ test_RealDAT_x4_exp1 iter
	 # ssim: 0.8262	Best: 0.8262 @ test_RealDAT_x4_exp1 iter

2024-11-01 00:39:33,460 INFO: Testing RealSR_Nikon...
2024-11-01 00:43:34,493 INFO: Validation RealSR_Nikon
	 # psnr: 28.1947	Best: 28.1947 @ test_RealDAT_x4_exp1 iter
	 # ssim: 0.7997	Best: 0.7997 @ test_RealDAT_x4_exp1 iter

2024-11-01 00:43:34,493 INFO: Testing Set5...
2024-11-01 00:43:36,012 INFO: Validation Set5
	 # psnr: 29.3617	Best: 29.3617 @ test_RealDAT_x4_exp1 iter
	 # ssim: 0.8539	Best: 0.8539 @ test_RealDAT_x4_exp1 iter

2024-11-01 00:43:36,012 INFO: Testing Set14...
2024-11-01 00:43:41,533 INFO: Validation Set14
	 # psnr: 26.6699	Best: 26.6699 @ test_RealDAT_x4_exp1 iter
	 # ssim: 0.7330	Best: 0.7330 @ test_RealDAT_x4_exp1 iter

